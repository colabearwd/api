{% extends "base.html" %}

{% block content %}
<div id="wrapper" class="col-lg-8 col-lg-offset-2" style="margin-top: 2%">
    <form action="" method="post">
        <label >Ping Temporary Task :</label> <br>

        <label for="endpoint_select">Raspberry Node:</label>
        <select id="endpoint_select" onchange="func(this.value)" class="form-control col-md-4">
            <option value="" selected>--请选择--</option>
            {% for ep in endpointlist %}
            <option value="{{ ep.map_ofid }}">{{ ep.map_ofname }} | {{ ep.map_desc }}</option>
            {% endfor %}
        </select>

        <div class="form-group">
            <label >目标地址 : </label> <input type="text" class="form-control col-md-4" placeholder="www.baidu.com">
        </div>
        <div class="form-group">
        <label >包大小 :   </label> <input type="text" class="form-control col-md-4" placeholder="默认数字64字节">
        </div>
        <div class="form-group">
        <label >超时时间 : </label> <input type="text" class="form-control col-md-4" placeholder="超时时间默认事5s">
        </div>
        <div class="form-group">
        <label >ip版本 :   </label> <input type="text" class="form-control col-md-4" placeholder="若是ipv4,请填写4;若是ipv6,请填写6">
        </div>
    </form>

</div>


<script>
        var endpoint_id;

        function func(m) {
            var xhttp = new XMLHttpRequest();
            endpoint_id = m;
            xhttp.onreadystatechange = function () {
                if (xhttp.readyState == 4 && xhttp.status == 200) {

                    var res = xhttp.responseText;
                    resjson = JSON.parse(res);
                    alert("这个节点有" + resjson.length + "参数");

                }
            };

            // xhttp.open("GET", "/counter/" + m, true);
            // xhttp.send();
            xhttp.open("POST", "/endpoint/counter/", true);
            xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhttp.send("endpoint_id="+m);

        }
</script>

{% endblock %}